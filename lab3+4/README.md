## Задание 2. Code Review и анализ уязвимостей (CWE)

Проанализировав предоставленный PHP-код, можно выделить следующие критические
уязвимости:
1. SQL Injection (Внедрение SQL-кода)
    * Анализ: Переменная $user попадает в SQL-запрос напрямую из
    $_GET['username'] без какой-либо фильтрации или использования
    подготовленных выражений (Prepared Statements). Переменная $pass
    хешируется, поэтому через нее инъекцию провести сложнее, но вектор через
    username открыт.
    * CWE-89: Improper Neutralization of Special Elements used in an SQL
    Command ('SQL Injection').
2. Использование HTTP GET для передачи чувствительных данных
    * Анализ: Логин и пароль передаются через параметры URL ($_GET). Это
    означает, что пароли сохраняются в истории браузера, логах прокси-серверов
    и access-логах веб-сервера.
    * CWE-598: Use of GET Request Method with Sensitive Query Strings.
3. Использование слабого алгоритма хеширования без "соли"
    * Анализ: Используется функция md5($pass). Алгоритм MD5 криптографически
    сломан, подвержен коллизиям и очень быстр, что позволяет злоумышленникам
    мгновенно подбирать пароли по радужным таблицам. Также отсутствует "соль"
    (salt).
    * CWE-327: Use of a Broken or Risky Cryptographic Algorithm.
    * CWE-759: Use of a One-Way Hash without a Salt.
4. Отсутствие ограничения попыток входа (Rate Limiting)
    * Анализ: В коде нет механизма, который блокировал бы пользователя или
    замедлял ответы после нескольких неудачных попыток. Это позволяет проводить
    Bruteforce-атаки (то, что мы делали в задании 1).
    * CWE-307: Improper Restriction of Excessive Authentication Attempts.
5. Раскрытие чувствительной информации в сообщениях об ошибках.
    * Анализ: Используется die( ... mysqli_error(...) ). В случае ошибки базы
    данных пользователю выводится полный текст ошибки SQL-сервера, что помогает
    злоумышленнику раскрутить SQL-инъекцию (Error-Based SQLi).
    * CWE-209: Generation of Error Message Containing Sensitive Information.
